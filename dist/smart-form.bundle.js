(()=>{"use strict";var e={56:(e,t,s)=>{e.exports=function(e){var t=s.nc;t&&e.setAttribute("nonce",t)}},72:e=>{var t=[];function s(e){for(var s=-1,n=0;n<t.length;n++)if(t[n].identifier===e){s=n;break}return s}function n(e,n){for(var i={},r=[],l=0;l<e.length;l++){var o=e[l],c=n.base?o[0]+n.base:o[0],u=i[c]||0,d="".concat(c," ").concat(u);i[c]=u+1;var h=s(d),p={css:o[1],media:o[2],sourceMap:o[3],supports:o[4],layer:o[5]};if(-1!==h)t[h].references++,t[h].updater(p);else{var f=a(p,n);n.byIndex=l,t.splice(l,0,{identifier:d,updater:f,references:1})}r.push(d)}return r}function a(e,t){var s=t.domAPI(t);return s.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;s.update(e=t)}else s.remove()}}e.exports=function(e,a){var i=n(e=e||[],a=a||{});return function(e){e=e||[];for(var r=0;r<i.length;r++){var l=s(i[r]);t[l].references--}for(var o=n(e,a),c=0;c<i.length;c++){var u=s(i[c]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}i=o}}},113:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},314:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var s="",n=void 0!==t[5];return t[4]&&(s+="@supports (".concat(t[4],") {")),t[2]&&(s+="@media ".concat(t[2]," {")),n&&(s+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),s+=e(t),n&&(s+="}"),t[2]&&(s+="}"),t[4]&&(s+="}"),s})).join("")},t.i=function(e,s,n,a,i){"string"==typeof e&&(e=[[null,e,void 0]]);var r={};if(n)for(var l=0;l<this.length;l++){var o=this[l][0];null!=o&&(r[o]=!0)}for(var c=0;c<e.length;c++){var u=[].concat(e[c]);n&&r[u[0]]||(void 0!==i&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=i),s&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=s):u[2]=s),a&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=a):u[4]="".concat(a)),t.push(u))}},t}},540:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},601:e=>{e.exports=function(e){return e[1]}},659:e=>{var t={};e.exports=function(e,s){var n=function(e){if(void 0===t[e]){var s=document.querySelector(e);if(window.HTMLIFrameElement&&s instanceof window.HTMLIFrameElement)try{s=s.contentDocument.head}catch(e){s=null}t[e]=s}return t[e]}(e);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(s)}},825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(s){!function(e,t,s){var n="";s.supports&&(n+="@supports (".concat(s.supports,") {")),s.media&&(n+="@media ".concat(s.media," {"));var a=void 0!==s.layer;a&&(n+="@layer".concat(s.layer.length>0?" ".concat(s.layer):""," {")),n+=s.css,a&&(n+="}"),s.media&&(n+="}"),s.supports&&(n+="}");var i=s.sourceMap;i&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(n,e,t.options)}(t,e,s)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},904:(e,t,s)=>{s.d(t,{A:()=>l});var n=s(601),a=s.n(n),i=s(314),r=s.n(i)()(a());r.push([e.id,".uoyroem-form [data-visible=true]{transform:translateX(0);opacity:1;transition:transform .3s ease,opacity .3s ease}.uoyroem-form [data-visible=false]{transform:translateX(100%);opacity:0;transition:transform .3s ease,opacity .3s ease}.uoyroem-form .autofill{outline:dashed blue}",""]);const l=r}},t={};function s(n){var a=t[n];if(void 0!==a)return a.exports;var i=t[n]={id:n,exports:{}};return e[n](i,i.exports,s),i.exports}s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.nc=void 0;var n={};s.r(n),s.d(n,{Uoyroem:()=>a});var a,i=s(72),r=s.n(i),l=s(825),o=s.n(l),c=s(659),u=s.n(c),d=s(56),h=s.n(d),p=s(540),f=s.n(p),g=s(113),m=s.n(g),y=s(904),_={};_.styleTagTransform=m(),_.setAttributes=h(),_.insert=u().bind(null,"head"),_.domAPI=o(),_.insertStyleElement=f(),r()(y.A,_),y.A&&y.A.locals&&y.A.locals,function(e){function t(e,s){if(e===s)return!0;if("object"!=typeof e||"object"!=typeof s||null===e||null===s)return!1;const n=new Set(Object.keys(e)),a=new Set(Object.keys(s));if(n.size!==a.size)return!1;for(const a of n)if(!t(e[a],s[a]))return!1;return!0}function s(e,t){return`${e}:${t}`}e.getMetaDependencyKey=s;class n{constructor(){this._nameEffect=new Map,this._names=new Set,this._dependentMap=new Map,this._dependencyMap=new Map,this._addedDependencies=[],this._nameEffect=new Map,this._names=new Set,this._dependentMap=new Map,this._dependencyMap=new Map,this._addedDependencies=[],this._topologicalOrder=[]}buildDependenciesMap(){this._dependentMap=new Map,this._dependencyMap=new Map,this._names=new Set,this._topologicalOrder=[];const e=[];for(const[t,s]of this._nameEffect)for(const n of s.dependsOn)e.push([t,n]);e.push(...this._addedDependencies);for(const[t,s]of e)this._names.add(t),this._names.add(s),this._dependentMap.has(t)||this._dependentMap.set(t,new Set),this._dependentMap.has(s)||this._dependentMap.set(s,new Set),this._dependencyMap.has(t)||this._dependencyMap.set(t,new Set),this._dependencyMap.has(s)||this._dependencyMap.set(s,new Set),this._dependentMap.get(t).add(s),this._dependencyMap.get(s).add(t);const t=new Map;for(const[e,s]of this._dependentMap)t.set(e,s.size);const s=[];for(const[e,n]of t)0===n&&s.push(e);for(;s.length>0;){const e=s.shift();this._topologicalOrder.push(e);for(const n of this._dependencyMap.get(e))t.set(n,t.get(n)-1),0===t.get(n)&&s.push(n)}if(this._topologicalOrder.length!==this._names.size)throw new Error("There are cyclic dependencies")}addDependency(e,t){this._addedDependencies.push([e,t])}addEffect(e,t){this._nameEffect.set(e,t)}async triggerEffects({changedNames:e=null}={}){for(const t of this._topologicalOrder){if(null!=e&&0===this._dependentMap.get(t).intersection(e).size)continue;const s=this._nameEffect.get(t);if(null!=s){const t=await s.callback();e&&t.forEach((t=>{e.add(t)}))}else e&&e.add(t)}}}e.EffectManager=n;class a{constructor(e){this.name=e}validate(e){}}e.FormFieldValidator=a,e.FormFieldValidatorRequired=class extends a{constructor(){super("Required")}validate(e){}};class i{static object(){return new h}static text(){return new r}static number(){return new l}static date(){return new o}static select({multiple:e=!1}={}){return(new d).multiple(e)}static checkbox(){return new u}static radio(){return new c}static isFormElement(e){return e instanceof HTMLInputElement||e instanceof HTMLSelectElement||e instanceof HTMLTextAreaElement}static fromFormElement(e){switch(e.type){case"select-one":return this.select();case"select-multiple":return this.select().multiple();case"number":return this.number();case"text":return this.text();case"textarea":return this.text().area();case"checkbox":return this.checkbox();case"radio":return this.radio();case"date":return this.date();default:throw new Error(`As element type ${e} not has`)}}constructor(e){this.name=e}isEqual(e,t){return e===t}isEmpty(){}asElementType(){return"hidden"}getFieldValue(e){return e.getValue()}getFieldMetaValue(e,t){return e.getMetaValue(t)}setFieldValue(e,t){return e.setValue(t)}setFieldMetaValue(e,t,s){return e.setMetaValue(t,s)}getInitialValue(){return null}getInitialMeta(){const e=new Map;return e.set("disabled",!1),e.set("dirty",!1),e}isSameType(e){return this.name===e.name}}e.FormFieldType=i;class r extends i{constructor(){super("String"),this._area=!1}area(e=!0){return this._area=e,this}asElementType(){return this._area?"textarea":"text"}}e.FormFieldTypeText=r;class l extends i{constructor(){super("Number")}asElementType(){return"number"}}e.FormFieldTypeNumber=l;class o extends i{constructor(){super("Date")}asElementType(){return"date"}isEqual(e,t){return e.toDateString()===t.toDateString()}}e.FormFieldTypeDate=o;class c extends i{constructor(){super("Radio")}asElementType(){return"radio"}getInitialMeta(){const e=super.getInitialMeta();return e.set("checked",!1),e}getFieldValue(e){return e.getMetaValue("checked")?e.getValue():null}setFieldValue(e,t){return e.setMetaValue("checked",null!=t&&e.getValue()===t)}}e.FormFieldTypeRadio=c;class u extends i{constructor(){super("Checkbox")}asElementType(){return"checkbox"}getInitialMeta(){const e=super.getInitialMeta();return e.set("checked",!1),e}getFieldValue(e){const t=e.getValue();return["","on"].includes(t)?e.getMetaValue("checked"):e.getMetaValue("checked")?t:null}setFieldValue(e,t){return["","on"].includes(e.getValue())?e.setMetaValue("checked",t):e.setMetaValue("checked",null!=t&&e.getValue()===t)}}e.FormFieldTypeCheckbox=u;class d extends i{constructor(){super("select"),this._multiple=!1,this._of=i.text()}asElementType(){return this._multiple?"select-multiple":"select-one"}getInitialMeta(){const e=super.getInitialMeta();return e.set("optionsInitialized",!1),e}multiple(e=!0){return this._multiple=e,this}of(e){return this._of=e,this}}e.FormFieldTypeSelect=d;class h extends i{constructor(){super("Object")}isEqual(e,s){return t(e,s)}}let p;e.FormFieldTypeObject=h,function(e){e.VALUE="value",e.META_VALUE="metavalue"}(p=e.ChangeType||(e.ChangeType={}));class f extends Event{constructor(e){super("changes",{cancelable:!0}),this.changes=e}}e.ChangesEvent=f;class g{constructor(e=128){this._changes=[],this._maxSize=e}trimProcessedChanges(){for(;this._changes.length>this._maxSize;){const e=this._changes.findIndex((e=>e.processed));if(-1===e)break;this._changes.splice(e,1)}}add(e){let t=null;e.type===p.VALUE?t=this.getFieldChange(e.field,{type:p.VALUE}):e.type===p.META_VALUE&&(t=this.getFieldChange(e.field,{type:p.META_VALUE,metaKey:e.metaKey})),null!=t&&(t.last=!1),this._changes.push(e),this.trimProcessedChanges()}remove(e){this._changes.splice(this._changes.indexOf(e),1)}getFieldChange(e,{onlyCurrentState:t=!0,last:s=!0,processed:n=!1,type:a=null,metaKey:i=null}={}){let r=this.getFieldChanges(e,{onlyCurrentState:t,last:s,processed:n,type:a});return a===p.META_VALUE&&null!=i&&(r=r.filter((e=>e.metaKey===i))),r.at(-1)}getFieldChanges(e,{onlyCurrentState:t=!0,last:s=!0,processed:n=!1,type:a=null}={}){let i=this._changes.filter((t=>t.field===e));return null!=a&&(i=i.filter((e=>e.type===a))),null!=s&&(i=i.filter((e=>e.last===s))),null!=n&&(i=i.filter((e=>e.processed===n))),t&&(i=i.filter((t=>t.stateKey===e.currentStateKey))),i}hasChanges(e){return 0!==this.getFieldChanges(e,{onlyCurrentState:!0,last:!0}).length}markProcessed(e){e.forEach((e=>{e.processed=!0})),this.trimProcessedChanges()}static asChangedName(e){return"value"===e.type?e.field.name:"metavalue"===e.type?s(e.field.name,e.metaKey):null}static asChangedNames(e){const t=new Set;for(const s of e){const e=this.asChangedName(s);null!=e&&t.add(e)}return t}processChanges(e,t=null,s=!1){const n=this.getFieldChanges(e,{onlyCurrentState:!0,type:t});return s||(this.markProcessed(this.getFieldChanges(e,{onlyCurrentState:!0,last:null,type:t})),e.dispatchEvent(new f(n))),g.asChangedNames(n)}}e.FormFieldChangeSet=g;class m extends EventTarget{constructor(e,t,{changeSet:s=null,effectManager:n=null}={}){super(),this._name=e,this._type=t,this._initializedStateKeys=new Set,this._initialValue=this.type.getInitialValue(),this._valueMap=new Map,this._initialMeta=this.type.getInitialMeta(),this._metaMap=new Map,this._changeSet=s??new g(32),this._currentStateKey="default",this.initializeState({stateKey:"default"}),null!=n&&this.initializeDependencies(n)}get self(){return this}get currentStateKey(){return this._currentStateKey}get context(){return{disabledIsNull:!0,initiator:null,stateKey:null,raw:!1,processChanges:!1}}get changeSet(){return this._changeSet}get name(){return this._name}get type(){return this._type}clearInitialMeta(){this._initialMeta=new Map}reset({stateKey:e=null,initiator:t=null,processChanges:s=!1}={}){e??(e=this._currentStateKey),console.log("[FormField.reset] Reset state `%s` for field `%s`",e,this.name),this.setValue(this._initialValue,{raw:!0,stateKey:e,initiator:t});for(const[s,n]of this._initialMeta.entries())this.setMetaValue(s,n,{raw:!0,stateKey:e,initiator:t});return this.processChanges(null,!s)}initializeState({stateKey:e,initiator:t=null}){this._initializedStateKeys.has(e)||(console.log("[FormField.initializeState] Initializing state key `%s` for field `%s`",e,this.name),this._initializedStateKeys.add(e),this._valueMap.set(e,null),this._metaMap.set(e,new Map),this.reset({stateKey:e,initiator:t,processChanges:!0}))}switchState({stateKey:e,initiator:t=null,processChanges:s=!1}){console.log("[FormField.switchState] Switching state for field `%s` from `%s` to `%s`",this.name,this._currentStateKey,e),this.initializeState({stateKey:e,initiator:t});const n=this._valueMap.get(this._currentStateKey),a=this._valueMap.get(e);if(!this.type.isEqual(n,a)){const s={stateKey:e,type:p.VALUE,field:this,initiator:t,oldValue:n,newValue:a,date:new Date,last:!0,processed:!1};this.changeSet.add(s)}for(const[s,n]of this._metaMap.get(e).entries()){const a=this._metaMap.get(this._currentStateKey).get(s);if(a!==n){const i={stateKey:e,type:p.META_VALUE,field:this,initiator:t,metaKey:s,oldValue:a,newValue:n,date:new Date,last:!0,processed:!1};this.changeSet.add(i)}}return this._currentStateKey=e,this.processChanges(null,!s)}initializeDependencies(e){switch(e.addDependency(this.name,s(this.name,"disabled")),this.type.asElementType()){case"checkbox":case"radio":e.addDependency(this.name,s(this.name,"checked"))}}getAdapter(e){return new Proxy(this,{get(t,s,n){switch(s){case"self":return t;case"context":return e;case"getAdapter":return(s={})=>t.getAdapter({...e,...s});case"getValue":return(s={})=>t.getValue({...e,...s});case"getMetaValue":return(s,n={})=>t.getMetaValue(s,{...e,...n});case"setValue":return(s,n={})=>t.setValue(s,{...e,...n});case"setMetaValue":return(s,n,a={})=>t.setMetaValue(s,n,{...e,...a});default:const a=Reflect.get(t,s,n);return"function"==typeof a?a.bind(t):a}}})}getValue({stateKey:e=null,raw:t=!1,disabledIsNull:s=!0}={}){return t?(e??(e=this._currentStateKey),this.initializeState({stateKey:e}),this._valueMap.get(e)):s&&this.getMetaValue("disabled",{stateKey:e})?null:this.type.getFieldValue(this.getAdapter({stateKey:e,raw:!0}))}setInitialValue(e){this._initialValue=e}setValue(e,{stateKey:t=null,raw:s=!1,initiator:n=null,processChanges:a=!1}={}){if(s){n??(n=this),t??(t=this._currentStateKey),this.initializeState({stateKey:t,initiator:n});const s=this.getValue({stateKey:t,raw:!0});if(this.type.isEqual(s,e))return new Set;this._valueMap.set(t,e);const i={stateKey:t,type:p.VALUE,field:this,initiator:n,oldValue:s,newValue:e,date:new Date,last:!0,processed:!1};return console.log("[FormField.setValue] Value changed:",{oldValue:s,newValue:e,stateKey:t}),this.changeSet.add(i),this.processChanges(p.VALUE,!a)}return this.type.setFieldValue(this.getAdapter({stateKey:t,raw:!0,processChanges:a,initiator:n}),e)}getMetaValue(e,{stateKey:t=null,raw:s=!1}={}){return s?(t??(t=this._currentStateKey),this.initializeState({stateKey:t}),this._metaMap.get(t).get(e)):this.type.getFieldMetaValue(this.getAdapter({raw:!0,stateKey:t}),e)}setInitialMetaValue(e,t){this._initialMeta.set(e,t)}setMetaValue(e,t,{stateKey:n=null,initiator:a=null,processChanges:i=!1,raw:r=!1}={}){if(r){a??(a=this),n??(n=this._currentStateKey),this.initializeState({stateKey:n,initiator:a});const r=this.getMetaValue(e,{stateKey:n});if(r===t)return new Set;this._metaMap.get(n).set(e,t);const l={stateKey:n,type:p.META_VALUE,field:this,initiator:a,metaKey:e,oldValue:r,newValue:t,date:new Date,last:!0,processed:!1};return this.changeSet.add(l),console.log("[FormField.setMetaValue] Meta",s(this.name,e),"value changed:",{oldValue:r,newValue:t,stateKey:n}),this.processChanges(p.META_VALUE,!i)}return this.type.setFieldMetaValue(this.getAdapter({stateKey:n,raw:!0,initiator:a,processChanges:i}),e,t)}processChanges(e=null,t=!1){return this.changeSet.processChanges(this,e,t)}}e.FormField=m;class y{constructor(e){this.fieldArray=e}getAdapter(e){return new Proxy(this,{get(t,s,n){switch(s){case"self":return t;case"context":return e;case"getAdapter":return(s={})=>t.getAdapter({...e,...s});case"getValue":return(s={})=>t.getValue({...e,...s});case"getMetaValue":return(s,n={})=>t.getMetaValue(s,{...e,...n});case"setValue":return(s,n={})=>t.setValue(s,{...e,...n});case"setMetaValue":return(s,n,a={})=>t.setMetaValue(s,n,{...e,...a});default:const a=Reflect.get(t,s,n);return"function"==typeof a?a.bind(t):a}}})}getValue({stateKey:e=null,disabledIsNull:t=!0,raw:s=!1}={}){return this.fieldArray.map((n=>n.getValue({stateKey:e,disabledIsNull:t,raw:s}))).find((e=>null!=e))}getMetaValue(e,{stateKey:t=null,raw:s=!1}={}){return this.fieldArray.map((n=>n.getMetaValue(e,{stateKey:t,raw:s}))).find((e=>null!=e))}setValue(e,{stateKey:t=null,initiator:s=null,processChanges:n=!1,raw:a=!1}={}){return this.fieldArray.map((i=>i.setValue(e,{stateKey:t,initiator:s,processChanges:n,raw:a}))).find((e=>0!==e.size))??new Set}setMetaValue(e,t,{stateKey:s=null,initiator:n=null,processChanges:a=!1,raw:i=!1}={}){return this.fieldArray.map((r=>r.setMetaValue(e,t,{stateKey:s,initiator:n,processChanges:a,raw:i}))).find((e=>0!==e.size))??new Set}processChanges(e=null,t=!1){return this.fieldArray.map((s=>s.processChanges(e,t))).find((e=>0!==e.size))??new Set}}e.FormFieldArray=y;class _{constructor(e){this.field=e,this.type=e.type}}e.FormFieldLinker=_;class M extends _{constructor(e,t){if(super(e),this.element=t,this.type.asElementType()!==this.element.type)throw new Error("For link type is equal");this._fieldChangesEventListener=this._fieldChangesEventListener.bind(this),this._elementValueInputEventListener=this._elementValueInputEventListener.bind(this),this._elementValueChangeEventListener=this._elementValueChangeEventListener.bind(this),this._handleHideContainer=null,this._mutationObserver=new MutationObserver((e=>{for(const t of e)"attributes"===t.type&&"disabled"===t.attributeName&&this._syncFieldMetaValue("disabled")}))}link(){this.field.setInitialValue(this._getElementValue()),this.field.setInitialMetaValue("disabled",this._getElementMetaValue("disabled")),this.field.setInitialMetaValue("visible",!0),["radio","checkbox"].includes(this.type.asElementType())&&this.field.setInitialMetaValue("checked",this._getElementMetaValue("checked")),this.field.reset({processChanges:!0,initiator:this}),this.field.addEventListener("changes",this._fieldChangesEventListener),["text","number","textarea"].includes(this.type.asElementType())?this.element.addEventListener("input",this._elementValueInputEventListener):this.element.addEventListener("change",this._elementValueChangeEventListener),this._mutationObserver.observe(this.element,{attributes:!0,attributeFilter:["disabled"]})}unlink(){this.field.removeEventListener("changes",this._fieldChangesEventListener),["text","number","textarea"].includes(this.type.asElementType())?this.element.removeEventListener("input",this._elementValueInputEventListener):this.element.removeEventListener("change",this._elementValueChangeEventListener),this._mutationObserver.disconnect()}_elementValueInputEventListener(e){console.log("[FormFieldElementLinker._elementValueInputEventListener] Event"),this.field.setMetaValue("dirty",!0,{initiator:this,processChanges:!0}),this._syncFieldValue()}_elementValueChangeEventListener(e){this.field.setMetaValue("dirty",!0,{initiator:this,processChanges:!0}),["radio","checkbox"].includes(this.type.asElementType())?this._syncFieldMetaValue("checked"):this._syncFieldValue()}_fieldChangesEventListener(e){const t=e.changes.filter((e=>e.initiator!==this));for(const e of t)e.type===p.VALUE?this._syncElementValue()||this._syncFieldValue():e.type===p.META_VALUE&&this._syncElementMetaValue(e.metaKey)}_syncElementValue(){console.log("[FormFieldElementLinker._syncElementValue] Syncing element value");const e=this.field.getValue({raw:!0}),t=this.field.getMetaValue("optionsInitialized");switch(this.type.asElementType()){case"select-multiple":if(!t)return!0;const s=e.map((e=>this.element.querySelector(`option[value="${e}"]`)));return!s.some((e=>null==e))&&(s.forEach((e=>{e.selected=!0})),!0);case"select-one":if(!t)return!0;const n=this.element.querySelector(`option[value="${e}"]`);return null!=n&&(n.selected=!0,!0)}return this.element.value=e,!0}_getElementValue(){return this.element.value}_syncFieldValue(){console.log("[FormFieldElementLinker._syncFieldValue] Syncing field value"),this.field.setValue(this._getElementValue(),{initiator:this,processChanges:!0,raw:!0})}_syncElementMetaValue(e){console.log("[FormFieldElementLinker._syncElementMetaValue] Syncing element meta value");const t=this.field.getMetaValue(e,{raw:!0});switch(e){case"disabled":this.element.disabled=!!t;break;case"checked":this.element.checked=!!t;break;case"visible":const e=this.element.parentElement;null!=e&&(null!=this._handleHideContainer&&(e.removeEventListener("transitionend",this._handleHideContainer),this._handleHideContainer=null),t?"none"===e.style.display?(e.style.display="",requestAnimationFrame((()=>{e.dataset.visible="true"}))):e.dataset.visible="true":("none"!==e.style.display&&(this._handleHideContainer=t=>{e.style.display="none"},e.addEventListener("transitionend",this._handleHideContainer,{once:!0})),e.dataset.visible="false"));break;case"autofill":this.element.classList.toggle("autofill",!!t);break;case"optionsInitialized":t&&this._syncElementValue()}}_getElementMetaValue(e){switch(e){case"disabled":return this.element.disabled;case"checked":return this.element.checked}}_syncFieldMetaValue(e){console.log("[FormFieldElementLinker._syncFieldMeta] Syncing field meta value"),this.field.setMetaValue(e,this._getElementMetaValue(e),{initiator:this,processChanges:!0})}}e.FormFieldElementLinker=M;class V extends EventTarget{constructor(){super(),this.list=[],this._fieldChangesEventListener=this._fieldChangesEventListener.bind(this)}_fieldChangesEventListener(e){this.dispatchEvent(new f(e.changes))}add(e){return e=e.self,!this.list.includes(e)&&(e.addEventListener("changes",this._fieldChangesEventListener),this.list.push(e),!0)}remove(e){return e=e.self,!!this.list.includes(e)&&(e.removeEventListener("changes",this._fieldChangesEventListener),this.list.splice(this.list.indexOf(e),1),!0)}get(e){const t=this.list.filter((t=>t.name===e));return 1===t.length?t[0]:new y(t)}[Symbol.iterator](){return new Set(this.list.map((e=>e.name))).values()}}e.FormFields=V;class E{}e.FormChangesManager=E;class v extends E{manage(e,t){t.filter((t=>t.initiator!==e&&"radio"===t.field.type.asElementType()&&t.type===p.META_VALUE&&"checked"===t.metaKey&&t.newValue)).forEach((t=>{e.fields.list.filter((e=>e.name===t.field.name&&"radio"===e.type.asElementType()&&e!=t.field&&e.getMetaValue("checked"))).forEach((t=>{t.setMetaValue("checked",!1,{initiator:e,processChanges:!0})}))}))}}e.FormChangesForRadioManager=v;class w extends E{manage(e,t){0!==(t=t.filter((t=>t.initiator!==e))).length&&e.effectManager.triggerEffects({changedNames:g.asChangedNames(t)})}}e.FormChangesForTriggerEffectsManager=w;class b extends EventTarget{constructor({form:e}){super(),this.form=e,this.changeSet=new g,this.effectManager=new n,this.fields=new V,this.fieldLinkers=[],this._changesManagers=[],this._handleChanges=this._handleChanges.bind(this)}async setup(){null!=this.form&&(this.form.classList.add("uoyroem-form"),this.form.noValidate=!0,this.form.addEventListener("submit",(e=>{e.preventDefault(),this.submit().then((()=>this.reset()))})),this.form.addEventListener("reset",(e=>{e.preventDefault(),this.reset()})),this.fields.addEventListener("changes",this._handleChanges),this.registerChangesManager(new v),this.registerChangesManager(new w),this.registerElements())}_handleChanges(e){const t=e.changes;for(const e of this._changesManagers)e.manage(this,t)}registerChangesManager(e){this._changesManagers.push(e)}getFormData(){const e={};for(const t of this.fields)e[t]=this.fields.get(t).getValue();return e}registerElements(){for(const e of this.form.elements){if(!i.isFormElement(e))continue;if(""===e.name)continue;const t=new m(e.name,i.fromFormElement(e),{changeSet:this.changeSet,effectManager:this.effectManager}),s=new M(t,e);s.link(),this.fieldLinkers.push(s),this.fields.add(t)}}getElement(e){return this.form.elements.namedItem(e)}async validate(){return!0}async submit(){await this.validate()}reset(){for(const e of this.fields.list)e.reset({initiator:this});this.effectManager.triggerEffects()}addDisableWhenEffect(e,t,n){this.effectManager.addEffect(s(e,"disabled"),{type:"disable-when",callback:async()=>{const s=await t();return this.fields.get(e).getAdapter({initiator:this}).setMetaValue("disabled",s,{processChanges:!0})},dependsOn:n})}addVisibleWhenEffect(e,t,n){this.addDisableWhenEffect(e,(async()=>!await t()),n),this.effectManager.addEffect(s(e,"visible"),{type:"visible-when",callback:async()=>{const s=await t();return this.fields.get(e).getAdapter({initiator:this}).setMetaValue("visible",s,{processChanges:!0})},dependsOn:[s(e,"disabled")]})}addComputedFieldEffect(e,t,s,n){this.fields.add(new m(e,t,{changeSet:this.changeSet,effectManager:this.effectManager})),this.effectManager.addEffect(e,{type:"computed-field",callback:async()=>{const t=await s();return this.fields.get(e).setValue(t,{initiator:this,processChanges:!0})},dependsOn:n})}addFieldAutofillEffect(e,t,n){this.effectManager.addDependency(e,s(e,"autofill")),this.effectManager.addEffect(s(e,"autofill"),{type:"field-autofill",callback:async()=>{const s=this.fields.get(e).getAdapter({initiator:this}),n=s.getMetaValue("dirty");if(s.setMetaValue("autofill",!n),n)return s.processChanges();const a=await t();return s.setMetaValue("autofill",0!==s.setValue(a).size),s.processChanges()},dependsOn:[s(e,"dirty"),...n]})}addSelectOptionsInitializerEffect(e,t,s,n){this.effectManager.addEffect(e,{type:"select-options-initializer",callback:async()=>{const n=await t(),a=await s(),i=this.getElement(e),r=this.fields.get(e).getAdapter({initiator:this}),l=r.getValue({disabledIsNull:!1});r.setValue(n.value),i.innerHTML="";for(const e of[n,...a]){const t=document.createElement("option");t.value=e.value,t.textContent=e.textContent,i.options.add(t)}return r.setValue(l),r.setMetaValue("disabled",0===a.length),r.setMetaValue("optionsInitialized",0!==a.length),r.processChanges()},dependsOn:n})}}e.Form=b}(a||(a={}));var M=window;for(var V in n)M[V]=n[V];n.__esModule&&Object.defineProperty(M,"__esModule",{value:!0})})();